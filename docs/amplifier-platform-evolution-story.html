<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Amplifier Platform Evolution</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: #000;
            color: #fff;
            overflow: hidden;
        }

        .presentation {
            width: 100vw;
            height: 100vh;
            position: relative;
        }

        .slide {
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
            display: none;
            padding: 80px 120px;
            background: #000;
        }

        .slide.active {
            display: flex;
            flex-direction: column;
            justify-content: center;
            animation: fadeIn 0.5s ease-in-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Title Slide */
        .slide.title {
            text-align: center;
            justify-content: center;
        }

        .slide.title h1 {
            font-size: 84px;
            font-weight: 700;
            line-height: 1.1;
            margin-bottom: 40px;
            background: linear-gradient(135deg, #5E5CE6 0%, #8B89FF 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .slide.title .subtitle {
            font-size: 36px;
            color: #999;
            font-weight: 400;
            line-height: 1.4;
            max-width: 1200px;
            margin: 0 auto 60px;
        }

        .slide.title .date {
            font-size: 24px;
            color: #666;
            margin-top: 40px;
        }

        /* Standard Content Slides */
        h2 {
            font-size: 64px;
            font-weight: 700;
            margin-bottom: 60px;
            color: #5E5CE6;
        }

        h3 {
            font-size: 42px;
            font-weight: 600;
            margin-bottom: 30px;
            color: #fff;
        }

        p {
            font-size: 32px;
            line-height: 1.6;
            color: #ccc;
            margin-bottom: 20px;
        }

        ul {
            list-style: none;
            margin-bottom: 30px;
        }

        li {
            font-size: 36px;
            line-height: 1.8;
            color: #fff;
            margin-bottom: 24px;
            padding-left: 50px;
            position: relative;
        }

        li:before {
            content: '•';
            position: absolute;
            left: 0;
            color: #5E5CE6;
            font-size: 48px;
            line-height: 1.4;
        }

        /* Big Numbers */
        .big-number {
            font-size: 120px;
            font-weight: 700;
            background: linear-gradient(135deg, #5E5CE6 0%, #8B89FF 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 20px;
            line-height: 1;
        }

        .number-label {
            font-size: 28px;
            color: #999;
            margin-bottom: 50px;
        }

        /* Metrics Grid */
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 60px;
            margin-top: 40px;
        }

        .metric {
            text-align: center;
        }

        .metric .big-number {
            font-size: 96px;
        }

        .metric .number-label {
            font-size: 24px;
        }

        /* Before/After Comparison */
        .comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 80px;
            margin-top: 40px;
        }

        .comparison-column h3 {
            color: #5E5CE6;
            margin-bottom: 30px;
            text-align: center;
        }

        .comparison-column li {
            font-size: 28px;
        }

        /* Code Block */
        .code-block {
            background: #1a1a1a;
            border-radius: 12px;
            padding: 40px;
            margin: 40px 0;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 22px;
            line-height: 1.6;
            color: #30D158;
            overflow-x: auto;
        }

        .code-comment {
            color: #666;
        }

        /* Highlight Box */
        .highlight-box {
            background: rgba(94, 92, 230, 0.1);
            border-left: 4px solid #5E5CE6;
            padding: 40px;
            margin: 40px 0;
            border-radius: 8px;
        }

        .highlight-box p {
            font-size: 32px;
            color: #fff;
            margin: 0;
        }

        /* Challenge/Learning Layout */
        .journey-section {
            margin-bottom: 40px;
        }

        .journey-section h3 {
            font-size: 36px;
            color: #5E5CE6;
            margin-bottom: 20px;
        }

        .journey-section ul li {
            font-size: 28px;
        }

        /* Navigation */
        .nav-dots {
            position: fixed;
            bottom: 40px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 12px;
            z-index: 100;
        }

        .nav-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #333;
            cursor: pointer;
            transition: all 0.3s;
        }

        .nav-dot.active {
            background: #5E5CE6;
            transform: scale(1.3);
        }

        .slide-counter {
            position: fixed;
            bottom: 40px;
            right: 40px;
            font-size: 18px;
            color: #666;
            z-index: 100;
        }

        /* Click Navigation Areas */
        .nav-area {
            position: fixed;
            top: 0;
            height: 100%;
            width: 30%;
            cursor: pointer;
            z-index: 50;
        }

        .nav-area.prev {
            left: 0;
        }

        .nav-area.next {
            right: 0;
        }

        /* Takeaways */
        .takeaway {
            background: rgba(94, 92, 230, 0.05);
            padding: 30px 40px;
            border-radius: 12px;
            margin-bottom: 24px;
        }

        .takeaway strong {
            color: #5E5CE6;
            font-size: 32px;
        }

        .takeaway p {
            font-size: 28px;
            margin: 10px 0 0 0;
        }
    </style>
</head>
<body>
    <div class="presentation">
        <!-- Slide 1: Title -->
        <div class="slide active title">
            <h1>Amplifier Platform Evolution</h1>
            <div class="subtitle">Infrastructure, Quality & Pragmatic Decisions</div>
            <div class="subtitle" style="font-size: 28px; margin-top: 20px;">
                A week of PostgreSQL migration, 6x test coverage increase,<br>and learning when simpler wins
            </div>
            <div class="date">February 6-13, 2026</div>
        </div>

        <!-- Slide 2: By The Numbers -->
        <div class="slide">
            <h2>By The Numbers</h2>
            <div class="metrics-grid">
                <div class="metric">
                    <div class="big-number">3</div>
                    <div class="number-label">Development Sessions<br>39 Conversation Turns</div>
                </div>
                <div class="metric">
                    <div class="big-number">52</div>
                    <div class="number-label">Files Changed<br>11,383 insertions, 4,909 deletions</div>
                </div>
                <div class="metric">
                    <div class="big-number">6x</div>
                    <div class="number-label">Test Coverage Increase<br>67 → 400+ tests</div>
                </div>
                <div class="metric">
                    <div class="big-number">37</div>
                    <div class="number-label">REST API Endpoints<br>Simplified from 40</div>
                </div>
            </div>
        </div>

        <!-- Slide 3: Infrastructure Evolution -->
        <div class="slide">
            <h2>Infrastructure Evolution</h2>
            <h3>PostgreSQL Migration</h3>
            <ul>
                <li>Migrated from aiosqlite to asyncpg for production scale</li>
                <li>Added connection pooling for concurrent request handling</li>
                <li>New schema with JSONB columns (tags, metadata, transcripts)</li>
                <li>Multi-user session support via session_participants table</li>
                <li>Azure PostgreSQL ready with proper async patterns</li>
            </ul>
            <div class="highlight-box">
                <p><strong>Result:</strong> Production-ready database infrastructure that scales</p>
            </div>
        </div>

        <!-- Slide 4: Quality Leap -->
        <div class="slide">
            <h2>Quality Leap</h2>
            <h3>Test Suite Overhaul</h3>
            <ul>
                <li>Added 110+ new comprehensive tests in 4 new test files</li>
                <li>Removed 15+ obsolete tests for deleted endpoints</li>
                <li>Coverage: config validation, session management, database ops</li>
                <li>167 core tests verified passing</li>
                <li>Testing methodology: Unit (68) + Integration (99) + E2E (113)</li>
            </ul>
            <div class="highlight-box">
                <p><strong>Result:</strong> 6x increase in test coverage with systematic expansion</p>
            </div>
        </div>

        <!-- Slide 5: API Maturity -->
        <div class="slide">
            <h2>API Maturity</h2>
            <h3>Simplification Through Cleanup</h3>
            <ul>
                <li>Removed 3 helper endpoints (POST /configs/{id}/tools, /providers, /bundles)</li>
                <li>Users modify configs via direct PUT /configs/{id} with YAML</li>
                <li>Cleaner REST API following pure CRUD patterns</li>
                <li>Added global registry API for tools/providers/bundles</li>
                <li>JSON config storage with encryption (replaced YAML strings)</li>
            </ul>
            <div class="highlight-box">
                <p><strong>Result:</strong> 40 → 37 endpoints, clearer API surface</p>
            </div>
        </div>

        <!-- Slide 6: The Journey -->
        <div class="slide">
            <h2>The Journey</h2>
            <h3>Dependency Pinning Attempt</h3>
            <div class="journey-section">
                <h3 style="color: #fff;">The Problem</h3>
                <p>Wanted to pin module dependencies to specific commits for stability</p>
            </div>
            <div class="journey-section">
                <h3 style="color: #fff;">The Attempt</h3>
                <ul>
                    <li>Runtime pinning with pinned_sources.yaml config</li>
                    <li>Git clone during session startup</li>
                    <li>Hash-based URL references (#hash, @hash)</li>
                </ul>
            </div>
            <div class="journey-section">
                <h3 style="color: #fff;">The Challenges</h3>
                <ul>
                    <li>Git clone can't checkout arbitrary commits directly</li>
                    <li>URL format issues: #hash creates tarballs, @hash treats as branch</li>
                    <li>Permission issues, cache corruption, Docker build problems</li>
                </ul>
            </div>
        </div>

        <!-- Slide 7: The Learning -->
        <div class="slide">
            <h2>The Learning</h2>
            <h3>When Simpler Wins</h3>
            <ul>
                <li>Reverted to pre-installed modules in pyproject.toml pointing to @main</li>
                <li>Versions locked at Docker build time (not runtime)</li>
                <li>No runtime git complexity, faster session startup</li>
                <li>Simple dependency management that works with tooling</li>
            </ul>
            <div class="highlight-box">
                <p><strong>Key Insight:</strong> "Sometimes the simpler solution is better than fighting tooling limitations"</p>
            </div>
            <p style="margin-top: 40px; font-size: 28px; color: #999;">Reverting is engineering judgment, not failure</p>
        </div>

        <!-- Slide 8: JSON Storage Recovery -->
        <div class="slide">
            <h2>JSON Storage Recovery</h2>
            <h3>Rebuilding Lost Work</h3>
            <ul>
                <li>Accidentally lost during git revert of pinning attempt</li>
                <li>Recovered from patch files and git diffs</li>
                <li>Migrated config storage: YAML strings → JSON dicts</li>
                <li>Database: config_json JSONB column for structured data</li>
                <li>Added encryption support via ConfigEncryption</li>
            </ul>
            <div class="highlight-box">
                <p><strong>Result:</strong> Structured config storage with encryption ready</p>
            </div>
        </div>

        <!-- Slide 9: Before/After -->
        <div class="slide">
            <h2>Before/After Impact</h2>
            <div class="comparison">
                <div class="comparison-column">
                    <h3>Before</h3>
                    <ul>
                        <li>SQLite database</li>
                        <li>67 tests</li>
                        <li>YAML config strings</li>
                        <li>Complex dependency pinning ideas</li>
                        <li>40 API endpoints</li>
                        <li>Single-user sessions</li>
                    </ul>
                </div>
                <div class="comparison-column">
                    <h3>After</h3>
                    <ul>
                        <li>PostgreSQL with connection pooling</li>
                        <li>400+ tests (6x increase)</li>
                        <li>JSON config with encryption</li>
                        <li>@main Docker locking</li>
                        <li>37 API endpoints (simplified)</li>
                        <li>Multi-user session support</li>
                    </ul>
                </div>
            </div>
            <div class="highlight-box" style="margin-top: 40px;">
                <p><strong>Result:</strong> Production-scalable, comprehensively tested, pragmatically stable</p>
            </div>
        </div>

        <!-- Slide 10: Code Example -->
        <div class="slide">
            <h2>PostgreSQL Migration Pattern</h2>
            <h3>Evolution from SQLite to asyncpg</h3>
            <div class="code-block">
<span class="code-comment"># Before: SQLite</span>
async with aiosqlite.connect(db_path) as db:
    await db.execute("INSERT INTO sessions ...")

<span class="code-comment"># After: PostgreSQL with connection pooling</span>
pool = await asyncpg.create_pool(
    dsn=database_url,
    min_size=5,
    max_size=20
)
async with pool.acquire() as conn:
    await conn.execute("""
        INSERT INTO sessions (id, tags, metadata)
        VALUES ($1, $2, $3)
    """, session_id, tags_json, metadata_json)
            </div>
            <p style="font-size: 28px; color: #999;">JSONB columns enable structured data queries at database level</p>
        </div>

        <!-- Slide 11: Testing Methodology -->
        <div class="slide">
            <h2>Testing Methodology</h2>
            <h3>Comprehensive Coverage Strategy</h3>
            <ul>
                <li><strong>Unit Tests (68):</strong> Config validation, encryption, models</li>
                <li><strong>Integration Tests (99):</strong> Database operations, API endpoints</li>
                <li><strong>E2E Tests (113):</strong> Full request/response cycles</li>
            </ul>
            <div style="margin-top: 60px;">
                <h3 style="font-size: 36px;">New Test Files</h3>
                <ul>
                    <li>test_config_validation.py - Config schema validation</li>
                    <li>test_session_management.py - Multi-user session flows</li>
                    <li>test_database_operations.py - JSONB queries, pooling</li>
                    <li>test_encryption.py - ConfigEncryption verification</li>
                </ul>
            </div>
        </div>

        <!-- Slide 12: Key Takeaways -->
        <div class="slide">
            <h2>Key Takeaways</h2>
            <div class="takeaway">
                <strong>Infrastructure:</strong>
                <p>PostgreSQL migration enables production scale with connection pooling and JSONB</p>
            </div>
            <div class="takeaway">
                <strong>Quality:</strong>
                <p>6x test coverage increase through systematic expansion across all layers</p>
            </div>
            <div class="takeaway">
                <strong>Simplicity:</strong>
                <p>Pre-installed @main dependencies beat runtime pinning complexity</p>
            </div>
            <div class="takeaway">
                <strong>Pragmatism:</strong>
                <p>Reverting is engineering judgment, not failure—choose simpler when tooling fights you</p>
            </div>
            <div class="takeaway">
                <strong>Recovery:</strong>
                <p>JSON storage work successfully recovered from patches and diffs</p>
            </div>
        </div>

        <!-- Slide 13: What's Next -->
        <div class="slide">
            <h2>What's Next</h2>
            <ul>
                <li>Deploy JSON config storage to production</li>
                <li>Monitor Docker build stability with @main dependencies</li>
                <li>Continue E2E test automation refinement</li>
                <li>Azure PostgreSQL deployment planning</li>
                <li>Multi-user session feature rollout</li>
            </ul>
            <div class="highlight-box" style="margin-top: 80px;">
                <p><strong>Questions?</strong> Explore the amplifier-app-api repository</p>
            </div>
        </div>
    </div>

    <!-- Navigation -->
    <div class="nav-dots"></div>
    <div class="slide-counter"></div>
    <div class="nav-area prev"></div>
    <div class="nav-area next"></div>

    <script>
        let currentSlide = 0;
        const slides = document.querySelectorAll('.slide');
        const navDotsContainer = document.querySelector('.nav-dots');
        const slideCounter = document.querySelector('.slide-counter');

        // Create navigation dots
        slides.forEach((_, index) => {
            const dot = document.createElement('div');
            dot.classList.add('nav-dot');
            if (index === 0) dot.classList.add('active');
            dot.addEventListener('click', () => goToSlide(index));
            navDotsContainer.appendChild(dot);
        });

        const navDots = document.querySelectorAll('.nav-dot');

        function updateSlide() {
            slides.forEach((slide, index) => {
                slide.classList.toggle('active', index === currentSlide);
            });
            navDots.forEach((dot, index) => {
                dot.classList.toggle('active', index === currentSlide);
            });
            slideCounter.textContent = `${currentSlide + 1} / ${slides.length}`;
        }

        function nextSlide() {
            if (currentSlide < slides.length - 1) {
                currentSlide++;
                updateSlide();
            }
        }

        function prevSlide() {
            if (currentSlide > 0) {
                currentSlide--;
                updateSlide();
            }
        }

        function goToSlide(index) {
            currentSlide = index;
            updateSlide();
        }

        // Keyboard navigation
        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextSlide();
            } else if (e.key === 'ArrowLeft') {
                e.preventDefault();
                prevSlide();
            }
        });

        // Click navigation
        document.querySelector('.nav-area.prev').addEventListener('click', prevSlide);
        document.querySelector('.nav-area.next').addEventListener('click', nextSlide);

        // Initialize
        updateSlide();
    </script>
</body>
</html>